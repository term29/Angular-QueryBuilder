/**
 * angular2-query-builder - A modernized Angular 2+ query builder based on jquery QueryBuilder
 * @version v0.4.0
 * @author Zeb Zhao
 * @link https://github.com/zebzhao/Angular-QueryBuilder#readme
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@angular/core"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define(["@angular/core","@angular/forms","@angular/common"],t):"object"==typeof exports?exports["angular2-query-builder"]=t(require("@angular/core"),require("@angular/forms"),require("@angular/common")):e["angular2-query-builder"]=t(e.ng.core,e.ng.forms,e.ng.common)}("undefined"!=typeof self?self:this,function(e,t,n){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=12)}([function(t,n){t.exports=e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(13))},function(e,n){e.exports=t},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryOperator]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryOperatorDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryField]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryFieldDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryEntity]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryEntityDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[querySwitchGroup]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QuerySwitchGroupDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryButtonGroup]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryButtonGroupDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return Object.defineProperty(e.prototype,"queryInputType",{get:function(){return this._type},set:function(e){e&&(this._type=e)},enumerable:!0,configurable:!0}),o([i.Input(),r("design:type",String),r("design:paramtypes",[String])],e.prototype,"queryInputType",null),e=o([i.Directive({selector:"[queryInput]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryInputDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryRemoveButton]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryRemoveButtonDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryEmptyWarning]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryEmptyWarningDirective=a},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=function(){function e(e){this.template=e}return e=o([i.Directive({selector:"[queryArrowIcon]"}),r("design:paramtypes",[i.TemplateRef])],e)}();t.QueryArrowIconDirective=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1);t.QueryBuilderComponent=o.QueryBuilderComponent;var r=n(19);t.QueryBuilderModule=r.QueryBuilderModule},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(14)),o(n(7)),o(n(5)),o(n(4)),o(n(8)),o(n(3)),o(n(6)),o(n(9)),o(n(10)),o(n(11))},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(3),l=n(4),s=n(5),u=n(6),p=n(7),c=n(8),d=n(9),h=n(10),f=n(11),g=n(0);t.CONTROL_VALUE_ACCESSOR={provide:i.NG_VALUE_ACCESSOR,useExisting:g.forwardRef(function(){return y}),multi:!0},t.VALIDATOR={provide:i.NG_VALIDATORS,useExisting:g.forwardRef(function(){return y}),multi:!0};var y=function(){function e(e){var t=this;this.changeDetectorRef=e,this.defaultClassNames={arrowIconButton:"q-arrow-icon-button",arrowIcon:"q-icon q-arrow-icon",removeIcon:"q-icon q-remove-icon",addIcon:"q-icon q-add-icon",button:"q-button",buttonGroup:"q-button-group",removeButton:"q-remove-button",switchGroup:"q-switch-group",switchLabel:"q-switch-label",switchRadio:"q-switch-radio",rightAlign:"q-right-align",transition:"q-transition",collapsed:"q-collapsed",treeContainer:"q-tree-container",tree:"q-tree",row:"q-row",connector:"q-connector",rule:"q-rule",ruleSet:"q-ruleset",invalidRuleSet:"q-invalid-ruleset",emptyWarning:"q-empty-warning",fieldControl:"q-field-control",fieldControlSize:"q-control-size",entityControl:"q-entity-control",entityControlSize:"q-control-size",operatorControl:"q-operator-control",operatorControlSize:"q-control-size",inputControl:"q-input-control",inputControlSize:"q-control-size"},this.defaultOperatorMap={string:["=","!=","contains","like"],number:["=","!=",">",">=","<","<="],time:["=","!=",">",">=","<","<="],date:["=","!=",">",">=","<","<="],category:["=","!=","in","not in"],boolean:["="]},this.data={condition:"and",rules:[]},this.allowRuleset=!0,this.allowCollapse=!1,this.emptyMessage="A ruleset cannot be empty. Please add a rule or remove it all together.",this.config={fields:{}},this.defaultTemplateTypes=["string","number","time","date","category","boolean","multiselect"],this.defaultEmptyList=[],this.inputContextCache=new Map,this.operatorContextCache=new Map,this.fieldContextCache=new Map,this.entityContextCache=new Map,this.removeButtonContextCache=new Map,this.getDisabledState=function(){return t.disabled}}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(e){var t=this.config,n=typeof t;if("object"!==n)throw new Error("Expected 'config' must be a valid object, got "+n+" instead.");this.fields=Object.keys(t.fields).map(function(e){var n=t.fields[e];return n.value=n.value||e,n}),t.entities?this.entities=Object.keys(t.entities).map(function(e){var n=t.entities[e];return n.value=n.value||e,n}):this.entities=null,this.operatorsCache={}},e.prototype.validate=function(e){var t={},n=[],o=!1;return!this.config.allowEmptyRulesets&&this.checkEmptyRuleInRuleset(this.data)&&(t.empty="Empty rulesets are not allowed.",o=!0),this.validateRulesInRuleset(this.data,n),n.length&&(t.rules=n,o=!0),o?t:null},Object.defineProperty(e.prototype,"value",{get:function(){return this.data},set:function(e){this.data=e||{condition:"and",rules:[]},this.handleDataChange()},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){var t=this;this.onChangeCallback=function(){return e(t.data)}},e.prototype.registerOnTouched=function(e){var t=this;this.onTouchedCallback=function(){return e(t.data)}},e.prototype.setDisabledState=function(e){this.disabled=e,this.changeDetectorRef.detectChanges()},e.prototype.findTemplateForRule=function(e){var t=this.getInputType(e.field,e.operator);if(t){var n=this.findQueryInput(t);return n?n.template:(-1===this.defaultTemplateTypes.indexOf(t)&&console.warn("Could not find template for field with type: "+t),null)}},e.prototype.findQueryInput=function(e){return(this.parentInputTemplates||this.inputTemplates).find(function(t){return t.queryInputType===e})},e.prototype.getOperators=function(e){if(this.operatorsCache[e])return this.operatorsCache[e];var t=this.defaultEmptyList,n=this.config.fields[e];if(this.config.getOperators)return this.config.getOperators(e,n);var o=n.type;return n&&n.operators?t=n.operators:o?(t=this.operatorMap&&this.operatorMap[o]||this.defaultOperatorMap[o]||this.defaultEmptyList,0===t.length&&console.warn("No operators found for field '"+e+"' with type "+n.type+". Please define an 'operators' property on the field or use the 'operatorMap' binding to fix this."),n.nullable&&(t=t.concat(["is null","is not null"]))):console.warn("No 'type' property found on field: '"+e+"'"),this.operatorsCache[e]=t,t},e.prototype.getFields=function(e){return this.entities&&e?this.fields.filter(function(t){return t&&t.entity===e}):this.fields},e.prototype.getInputType=function(e,t){if(this.config.getInputType)return this.config.getInputType(e,t);var n=this.config.fields[e].type;switch(t){case"is null":case"is not null":return null;case"in":case"not in":return"category"===n||"boolean"===n?"multiselect":n;default:return n}},e.prototype.getOptions=function(e){return this.config.getOptions?this.config.getOptions(e):this.config.fields[e].options||this.defaultEmptyList},e.prototype.getClassNames=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=this.classNames?this.classNames:this.defaultClassNames,r=t.map(function(t){return o[t]||e.defaultClassNames[t]}).filter(function(e){return!!e});return r.length?r.join(" "):null},e.prototype.getDefaultField=function(e){if(e){if(void 0!==e.defaultField)return this.getDefaultValue(e.defaultField);var t=this.fields.filter(function(t){return t&&t.entity===e.value});return t&&t.length?t[0]:(console.warn("No fields found for entity '"+e.name+"'. A 'defaultOperator' is also not specified on the field config. Operator value will default to null."),null)}return null},e.prototype.getDefaultOperator=function(e){if(e&&void 0!==e.defaultOperator)return this.getDefaultValue(e.defaultOperator);var t=this.getOperators(e.value);return t&&t.length?t[0]:(console.warn("No operators found for field '"+e.value+"'. A 'defaultOperator' is also not specified on the field config. Operator value will default to null."),null)},e.prototype.addRule=function(e){if(!this.disabled){if(e=e||this.data,this.config.addRule)this.config.addRule(e);else{var t=this.fields[0];e.rules=e.rules.concat([{field:t.value,operator:this.getDefaultOperator(t),value:this.getDefaultValue(t.defaultValue),entity:t.entity}])}this.handleTouched(),this.handleDataChange()}},e.prototype.removeRule=function(e,t){this.disabled||(t=t||this.data,this.config.removeRule?this.config.removeRule(e,t):t.rules=t.rules.filter(function(t){return t!==e}),this.inputContextCache.delete(e),this.operatorContextCache.delete(e),this.fieldContextCache.delete(e),this.entityContextCache.delete(e),this.removeButtonContextCache.delete(e),this.handleTouched(),this.handleDataChange())},e.prototype.addRuleSet=function(e){this.disabled||(e=e||this.data,this.config.addRuleSet?this.config.addRuleSet(e):e.rules=e.rules.concat([{condition:"and",rules:[]}]),this.handleTouched(),this.handleDataChange())},e.prototype.removeRuleSet=function(e,t){this.disabled||(e=e||this.data,t=t||this.parentValue,this.config.removeRuleSet?this.config.removeRuleSet(e,t):t.rules=t.rules.filter(function(t){return t!==e}),this.handleTouched(),this.handleDataChange())},e.prototype.transitionEnd=function(e){this.treeContainer.nativeElement.style.maxHeight=null},e.prototype.toggleCollapse=function(){var e=this;this.computedTreeContainerHeight(),setTimeout(function(){e.data.collapsed=!e.data.collapsed},100)},e.prototype.computedTreeContainerHeight=function(){var e=this.treeContainer.nativeElement;e&&e.firstElementChild&&(e.style.maxHeight=e.firstElementChild.clientHeight+8+"px")},e.prototype.changeCondition=function(e){this.disabled||(this.data.condition=e,this.handleTouched(),this.handleDataChange())},e.prototype.changeOperator=function(e){this.disabled||(this.config.coerceValueForOperator?e.value=this.config.coerceValueForOperator(e.operator,e.value,e):e.value=this.coerceValueForOperator(e.operator,e.value,e),this.handleTouched(),this.handleDataChange())},e.prototype.coerceValueForOperator=function(e,t,n){return"multiselect"!==this.getInputType(n.field,e)||Array.isArray(t)?t:[t]},e.prototype.changeInput=function(){this.disabled||(this.handleTouched(),this.handleDataChange())},e.prototype.changeField=function(e,t){if(!this.disabled){t.field=e;var n=this.config.fields[e];n&&void 0!==n.defaultValue?t.value=this.getDefaultValue(n.defaultValue):delete t.value,t.operator=this.getDefaultOperator(n),this.inputContextCache.delete(t),this.operatorContextCache.delete(t),this.fieldContextCache.delete(t),this.entityContextCache.delete(t),this.getInputContext(t),this.getFieldContext(t),this.getOperatorContext(t),this.getEntityContext(t),this.handleTouched(),this.handleDataChange()}},e.prototype.changeEntity=function(e,t){if(!this.disabled){var n=this.entities.find(function(t){return t.value===e}),o=this.getDefaultField(n);o?this.changeField(o.value,t):(this.handleTouched(),this.handleDataChange())}},e.prototype.getDefaultValue=function(e){switch(typeof e){case"function":return e();default:return e}},e.prototype.getOperatorTemplate=function(){var e=this.parentOperatorTemplate||this.operatorTemplate;return e?e.template:null},e.prototype.getFieldTemplate=function(){var e=this.parentFieldTemplate||this.fieldTemplate;return e?e.template:null},e.prototype.getEntityTemplate=function(){var e=this.parentEntityTemplate||this.entityTemplate;return e?e.template:null},e.prototype.getArrowIconTemplate=function(){var e=this.parentArrowIconTemplate||this.arrowIconTemplate;return e?e.template:null},e.prototype.getButtonGroupTemplate=function(){var e=this.parentButtonGroupTemplate||this.buttonGroupTemplate;return e?e.template:null},e.prototype.getSwitchGroupTemplate=function(){var e=this.parentSwitchGroupTemplate||this.switchGroupTemplate;return e?e.template:null},e.prototype.getRemoveButtonTemplate=function(){var e=this.parentRemoveButtonTemplate||this.removeButtonTemplate;return e?e.template:null},e.prototype.getEmptyWarningTemplate=function(){var e=this.parentEmptyWarningTemplate||this.emptyWarningTemplate;return e?e.template:null},e.prototype.getQueryItemClassName=function(e){var t=this.getClassNames("row","connector","transition");return t+=" "+this.getClassNames(e.ruleset?"ruleSet":"rule"),e.invalid&&(t+=" "+this.getClassNames("invalidRuleSet")),t},e.prototype.getButtonGroupContext=function(){return this.buttonGroupContext||(this.buttonGroupContext={addRule:this.addRule.bind(this),addRuleSet:this.allowRuleset&&this.addRuleSet.bind(this),removeRuleSet:this.allowRuleset&&this.parentValue&&this.removeRuleSet.bind(this),getDisabledState:this.getDisabledState,$implicit:this.data}),this.buttonGroupContext},e.prototype.getRemoveButtonContext=function(e){return this.removeButtonContextCache.has(e)||this.removeButtonContextCache.set(e,{removeRule:this.removeRule.bind(this),getDisabledState:this.getDisabledState,$implicit:e}),this.removeButtonContextCache.get(e)},e.prototype.getFieldContext=function(e){return this.fieldContextCache.has(e)||this.fieldContextCache.set(e,{onChange:this.changeField.bind(this),getFields:this.getFields.bind(this),getDisabledState:this.getDisabledState,fields:this.fields,$implicit:e}),this.fieldContextCache.get(e)},e.prototype.getEntityContext=function(e){return this.entityContextCache.has(e)||this.entityContextCache.set(e,{onChange:this.changeEntity.bind(this),getDisabledState:this.getDisabledState,entities:this.entities,$implicit:e}),this.entityContextCache.get(e)},e.prototype.getSwitchGroupContext=function(){return{onChange:this.changeCondition.bind(this),getDisabledState:this.getDisabledState,$implicit:this.data}},e.prototype.getArrowIconContext=function(){return{getDisabledState:this.getDisabledState,$implicit:this.data}},e.prototype.getEmptyWarningContext=function(){return{getDisabledState:this.getDisabledState,message:this.emptyMessage,$implicit:this.data}},e.prototype.getOperatorContext=function(e){return this.operatorContextCache.has(e)||this.operatorContextCache.set(e,{onChange:this.changeOperator.bind(this),getDisabledState:this.getDisabledState,operators:this.getOperators(e.field),$implicit:e}),this.operatorContextCache.get(e)},e.prototype.getInputContext=function(e){return this.inputContextCache.has(e)||this.inputContextCache.set(e,{onChange:this.changeInput.bind(this),getDisabledState:this.getDisabledState,options:this.getOptions(e.field),field:this.config.fields[e.field],$implicit:e}),this.inputContextCache.get(e)},e.prototype.checkEmptyRuleInRuleset=function(e){var t=this;return!e||!e.rules||0===e.rules.length||e.rules.some(function(e){return!!e.rules&&t.checkEmptyRuleInRuleset(e)})},e.prototype.validateRulesInRuleset=function(e,t){var n=this;e&&e.rules&&e.rules.length>0&&e.rules.forEach(function(o){if(o.rules)return n.validateRulesInRuleset(o,t);if(o.field){var r=n.config.fields[o.field];if(r&&r.validator&&r.validator.apply){var i=r.validator(o,e);null!=i&&t.push(i)}}})},e.prototype.handleDataChange=function(){this.changeDetectorRef.markForCheck(),this.onChangeCallback&&this.onChangeCallback(),this.parentChangeCallback&&this.parentChangeCallback()},e.prototype.handleTouched=function(){this.onTouchedCallback&&this.onTouchedCallback(),this.parentTouchedCallback&&this.parentTouchedCallback()},o([g.Input(),r("design:type",Boolean)],e.prototype,"disabled",void 0),o([g.Input(),r("design:type",Object)],e.prototype,"data",void 0),o([g.Input(),r("design:type",Boolean)],e.prototype,"allowRuleset",void 0),o([g.Input(),r("design:type",Boolean)],e.prototype,"allowCollapse",void 0),o([g.Input(),r("design:type",String)],e.prototype,"emptyMessage",void 0),o([g.Input(),r("design:type",Object)],e.prototype,"classNames",void 0),o([g.Input(),r("design:type",Object)],e.prototype,"operatorMap",void 0),o([g.Input(),r("design:type",Object)],e.prototype,"parentValue",void 0),o([g.Input(),r("design:type",Object)],e.prototype,"config",void 0),o([g.Input(),r("design:type",f.QueryArrowIconDirective)],e.prototype,"parentArrowIconTemplate",void 0),o([g.Input(),r("design:type",g.QueryList)],e.prototype,"parentInputTemplates",void 0),o([g.Input(),r("design:type",a.QueryOperatorDirective)],e.prototype,"parentOperatorTemplate",void 0),o([g.Input(),r("design:type",l.QueryFieldDirective)],e.prototype,"parentFieldTemplate",void 0),o([g.Input(),r("design:type",s.QueryEntityDirective)],e.prototype,"parentEntityTemplate",void 0),o([g.Input(),r("design:type",u.QuerySwitchGroupDirective)],e.prototype,"parentSwitchGroupTemplate",void 0),o([g.Input(),r("design:type",p.QueryButtonGroupDirective)],e.prototype,"parentButtonGroupTemplate",void 0),o([g.Input(),r("design:type",d.QueryRemoveButtonDirective)],e.prototype,"parentRemoveButtonTemplate",void 0),o([g.Input(),r("design:type",h.QueryEmptyWarningDirective)],e.prototype,"parentEmptyWarningTemplate",void 0),o([g.Input(),r("design:type",Function)],e.prototype,"parentChangeCallback",void 0),o([g.Input(),r("design:type",Function)],e.prototype,"parentTouchedCallback",void 0),o([g.ViewChild("treeContainer"),r("design:type",g.ElementRef)],e.prototype,"treeContainer",void 0),o([g.ContentChild(p.QueryButtonGroupDirective),r("design:type",p.QueryButtonGroupDirective)],e.prototype,"buttonGroupTemplate",void 0),o([g.ContentChild(u.QuerySwitchGroupDirective),r("design:type",u.QuerySwitchGroupDirective)],e.prototype,"switchGroupTemplate",void 0),o([g.ContentChild(l.QueryFieldDirective),r("design:type",l.QueryFieldDirective)],e.prototype,"fieldTemplate",void 0),o([g.ContentChild(s.QueryEntityDirective),r("design:type",s.QueryEntityDirective)],e.prototype,"entityTemplate",void 0),o([g.ContentChild(a.QueryOperatorDirective),r("design:type",a.QueryOperatorDirective)],e.prototype,"operatorTemplate",void 0),o([g.ContentChild(d.QueryRemoveButtonDirective),r("design:type",d.QueryRemoveButtonDirective)],e.prototype,"removeButtonTemplate",void 0),o([g.ContentChild(h.QueryEmptyWarningDirective),r("design:type",h.QueryEmptyWarningDirective)],e.prototype,"emptyWarningTemplate",void 0),o([g.ContentChildren(c.QueryInputDirective),r("design:type",g.QueryList)],e.prototype,"inputTemplates",void 0),o([g.ContentChild(f.QueryArrowIconDirective),r("design:type",f.QueryArrowIconDirective)],e.prototype,"arrowIconTemplate",void 0),o([g.Input(),r("design:type",Object),r("design:paramtypes",[Object])],e.prototype,"value",null),e=o([g.Component({selector:"query-builder",template:n(15),styles:[n(16)],providers:[t.CONTROL_VALUE_ACCESSOR,t.VALIDATOR]}),r("design:paramtypes",[g.ChangeDetectorRef])],e)}();t.QueryBuilderComponent=y},function(e,t){e.exports='<div [ngClass]="getClassNames(\'switchRow\')">\r\n  <ng-template #defaultArrowIcon>\r\n    <i [ngClass]="getClassNames(\'arrowIcon\')"></i>\r\n  </ng-template>\r\n\r\n  <a *ngIf="allowCollapse" (click)="toggleCollapse()" [ngClass]="getClassNames(\'arrowIconButton\', data.collapsed ? \'collapsed\' : null)">\r\n    <ng-container *ngIf="getArrowIconTemplate() as template; else defaultArrowIcon">\r\n      <ng-container *ngTemplateOutlet="template; context: getArrowIconContext()"></ng-container>\r\n    </ng-container>\r\n  </a>\r\n\r\n  <ng-container *ngIf="getButtonGroupTemplate() as template; else defaultButtonGroup">\r\n    <div [ngClass]="getClassNames(\'buttonGroup\', \'rightAlign\')">\r\n      <ng-container *ngTemplateOutlet="template; context: getButtonGroupContext()"></ng-container>\r\n    </div>\r\n  </ng-container>\r\n\r\n  <ng-template #defaultButtonGroup>\r\n    <div [ngClass]="getClassNames(\'buttonGroup\', \'rightAlign\')">\r\n      <button type="button" (click)="addRule()" [ngClass]="getClassNames(\'button\')" [disabled]=disabled>\r\n        <i [ngClass]="getClassNames(\'addIcon\')"></i> Rule\r\n      </button>\r\n      <button type="button" (click)="addRuleSet()" [ngClass]="getClassNames(\'button\')" *ngIf="allowRuleset" [disabled]=disabled>\r\n        <i [ngClass]="getClassNames(\'addIcon\')"></i> Ruleset\r\n      </button>\r\n      <ng-container *ngIf="!!parentValue && allowRuleset">\r\n        <button type="button" (click)="removeRuleSet()" [ngClass]="getClassNames(\'button\', \'removeButton\')" [disabled]=disabled>\r\n          <i [ngClass]="getClassNames(\'removeIcon\')"></i>\r\n        </button>\r\n      </ng-container>\r\n    </div>\r\n  </ng-template>\r\n\r\n  <ng-container *ngIf="getSwitchGroupTemplate() as template; else defaultSwitchGroup">\r\n    <ng-container *ngTemplateOutlet="template; context: getSwitchGroupContext()"></ng-container>\r\n  </ng-container>\r\n\r\n  <ng-template #defaultSwitchGroup>\r\n    <div [ngClass]="getClassNames(\'switchGroup\', \'transition\')" *ngIf="data">\r\n      <div [ngClass]="getClassNames(\'switchControl\')">\r\n        <input type="radio" [ngClass]="getClassNames(\'switchRadio\')" [(ngModel)]="data.condition" [disabled]=disabled value="and"\r\n          #andOption/>\r\n        <label (click)="changeCondition(andOption.value)" [ngClass]="getClassNames(\'switchLabel\')">AND</label>\r\n      </div>\r\n      <div [ngClass]="getClassNames(\'switchControl\')">\r\n        <input type="radio" [ngClass]="getClassNames(\'switchRadio\')" [(ngModel)]="data.condition" [disabled]=disabled value="or"\r\n          #orOption/>\r\n        <label (click)="changeCondition(orOption.value)" [ngClass]="getClassNames(\'switchLabel\')">OR</label>\r\n      </div>\r\n    </div>\r\n  </ng-template>\r\n</div>\r\n\r\n<div #treeContainer (transitionend)="transitionEnd($event)" [ngClass]="getClassNames(\'treeContainer\', data.collapsed ? \'collapsed\' : null)">\r\n  <ul [ngClass]="getClassNames(\'tree\')" *ngIf="data && data.rules">\r\n    <ng-container *ngFor="let rule of data.rules">\r\n      <ng-container *ngIf="{ruleset: !!rule.rules, invalid: !config.allowEmptyRulesets && rule.rules && rule.rules.length === 0} as local">\r\n        <li [ngClass]="getQueryItemClassName(local)">\r\n          <ng-container *ngIf="!local.ruleset">\r\n\r\n            <ng-container *ngIf="getRemoveButtonTemplate() as template; else defaultRemoveButton">\r\n              <div [ngClass]="getClassNames(\'buttonGroup\', \'rightAlign\')">\r\n                <ng-container *ngTemplateOutlet="template; context: getRemoveButtonContext(rule)"></ng-container>\r\n              </div>\r\n            </ng-container>\r\n\r\n            <ng-template #defaultRemoveButton>\r\n              <div [ngClass]="getClassNames(\'removeButtonSize\', \'rightAlign\')">\r\n                <button type="button" [ngClass]="getClassNames(\'button\', \'removeButton\')" (click)="removeRule(rule, data)" [disabled]=disabled>\r\n                  <i [ngClass]="getClassNames(\'removeIcon\')"></i>\r\n                </button>\r\n              </div>\r\n            </ng-template>\r\n\r\n            <div *ngIf="entities?.length > 0" class="q-inline-block-display">\r\n              <ng-container *ngIf="getEntityTemplate() as template; else defaultEntity">\r\n                <ng-container *ngTemplateOutlet="template; context: getEntityContext(rule)"></ng-container>\r\n              </ng-container>\r\n            </div>\r\n\r\n            <ng-template #defaultEntity>\r\n              <div [ngClass]="getClassNames(\'entityControlSize\')">\r\n                <select [ngClass]="getClassNames(\'entityControl\')" [(ngModel)]="rule.entity" (ngModelChange)="changeEntity($event, rule)"\r\n                  [disabled]="disabled">\r\n                  <option *ngFor="let entity of entities" [ngValue]="entity.value">\r\n                    {{entity.name}}\r\n                  </option>\r\n                </select>\r\n              </div>\r\n            </ng-template>\r\n\r\n            <ng-container *ngIf="getFieldTemplate() as template; else defaultField">\r\n              <ng-container *ngTemplateOutlet="template; context: getFieldContext(rule)"></ng-container>\r\n            </ng-container>\r\n\r\n            <ng-template #defaultField>\r\n              <div [ngClass]="getClassNames(\'fieldControlSize\')">\r\n                <select [ngClass]="getClassNames(\'fieldControl\')" [(ngModel)]="rule.field" (ngModelChange)="changeField($event, rule)" [disabled]="disabled">\r\n                  <option *ngFor="let field of getFields(rule.entity)" [ngValue]="field.value">\r\n                    {{field.name}}\r\n                  </option>\r\n                </select>\r\n              </div>\r\n            </ng-template>\r\n\r\n            <ng-container *ngIf="getOperatorTemplate() as template; else defaultOperator">\r\n              <ng-container *ngTemplateOutlet="template; context: getOperatorContext(rule)"></ng-container>\r\n            </ng-container>\r\n\r\n            <ng-template #defaultOperator>\r\n              <div [ngClass]="getClassNames(\'operatorControlSize\')">\r\n                <select [ngClass]="getClassNames(\'operatorControl\')" [(ngModel)]="rule.operator" (ngModelChange)="changeOperator(rule)" [disabled]="disabled">\r\n                  <option *ngFor="let operator of getOperators(rule.field)" [ngValue]="operator">\r\n                    {{operator}}\r\n                  </option>\r\n                </select>\r\n              </div>\r\n            </ng-template>\r\n\r\n            <ng-container *ngIf="findTemplateForRule(rule) as template; else defaultInput">\r\n              <ng-container *ngTemplateOutlet="template; context: getInputContext(rule)"></ng-container>\r\n            </ng-container>\r\n\r\n            <ng-template #defaultInput>\r\n              <div [ngClass]="getClassNames(\'inputControlSize\')" [ngSwitch]="getInputType(rule.field, rule.operator)">\r\n                <input [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'string\'" type="text">\r\n                <input [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'number\'" type="number">\r\n                <input [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'date\'" type="date">\r\n                <input [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'time\'" type="time">\r\n                <select [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'category\'">\r\n                  <option *ngFor="let opt of getOptions(rule.field)" [ngValue]="opt.value">\r\n                    {{opt.name}}\r\n                  </option>\r\n                </select>\r\n                <ng-container *ngSwitchCase="\'multiselect\'">\r\n                  <select [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                    multiple>\r\n                    <option *ngFor="let opt of getOptions(rule.field)" [ngValue]="opt.value">\r\n                      {{opt.name}}\r\n                    </option>\r\n                  </select>\r\n                </ng-container>\r\n                <input [ngClass]="getClassNames(\'inputControl\')" [(ngModel)]="rule.value" (ngModelChange)="changeInput()" [disabled]="disabled"\r\n                  *ngSwitchCase="\'boolean\'" type="checkbox">\r\n              </div>\r\n            </ng-template>\r\n\r\n          </ng-container>\r\n          <query-builder *ngIf="local.ruleset" [data]="rule" [disabled]="disabled" [parentTouchedCallback]="parentTouchedCallback || onTouchedCallback"\r\n            [parentChangeCallback]="parentChangeCallback || onChangeCallback" [parentInputTemplates]="parentInputTemplates || inputTemplates"\r\n            [parentOperatorTemplate]="parentOperatorTemplate || operatorTemplate" [parentFieldTemplate]="parentFieldTemplate || fieldTemplate"\r\n            [parentEntityTemplate]="parentEntityTemplate || entityTemplate" [parentSwitchGroupTemplate]="parentSwitchGroupTemplate || switchGroupTemplate"\r\n            [parentButtonGroupTemplate]="parentButtonGroupTemplate || buttonGroupTemplate" [parentRemoveButtonTemplate]="parentRemoveButtonTemplate || removeButtonTemplate"\r\n            [parentEmptyWarningTemplate]="parentEmptyWarningTemplate || emptyWarningTemplate" [parentArrowIconTemplate]="parentArrowIconTemplate || arrowIconTemplate"\r\n            [parentValue]="data" [classNames]="classNames" [config]="config" [allowRuleset]="allowRuleset" [allowCollapse]="allowCollapse"\r\n            [emptyMessage]="emptyMessage" [operatorMap]="operatorMap">\r\n          </query-builder>\r\n\r\n          <ng-container *ngIf="getEmptyWarningTemplate() as template; else defaultEmptyWarning">\r\n            <ng-container *ngIf="local.invalid">\r\n              <ng-container *ngTemplateOutlet="template; context: getEmptyWarningContext()"></ng-container>\r\n            </ng-container>\r\n          </ng-container>\r\n\r\n          <ng-template #defaultEmptyWarning>\r\n            <p [ngClass]="getClassNames(\'emptyWarning\')" *ngIf="local.invalid">\r\n              {{emptyMessage}}\r\n            </p>\r\n          </ng-template>\r\n        </li>\r\n      </ng-container>\r\n    </ng-container>\r\n  </ul>\r\n</div>\r\n'},function(e,t,n){var o=n(17);e.exports="string"==typeof o?o:o.toString()},function(e,t,n){t=e.exports=n(18)(!1),t.push([e.i,"@charset \"UTF-8\";\n:host {\n  display: block;\n  width: 100%; }\n  :host .q-icon {\n    font-style: normal;\n    font-size: 12px; }\n  :host .q-remove-icon::before {\n    content: '\\274C'; }\n  :host .q-arrow-icon-button {\n    float: left;\n    margin: 4px 6px 4px 0;\n    transform: rotate(90deg);\n    transition: linear 0.25s transform;\n    cursor: pointer; }\n    :host .q-arrow-icon-button.q-collapsed {\n      transform: rotate(0); }\n  :host .q-arrow-icon::before {\n    content: '\\25B6'; }\n  :host .q-add-icon {\n    color: #555; }\n    :host .q-add-icon::before {\n      content: '\\2795'; }\n  :host .q-remove-button {\n    color: #B3415D;\n    width: 31px; }\n  :host .q-switch-group, :host .q-button-group {\n    font-family: \"Lucida Grande\", Tahoma, Verdana, sans-serif;\n    overflow: hidden; }\n  :host .q-right-align {\n    float: right; }\n  :host .q-button {\n    margin-left: 8px;\n    padding: 0 8px;\n    background-color: white; }\n    :host .q-button:disabled {\n      display: none; }\n  :host .q-control-size {\n    display: inline-block;\n    vertical-align: top;\n    padding-right: 10px; }\n  :host .q-input-control, :host .q-operator-control, :host .q-field-control, :host .q-entity-control {\n    display: inline-block;\n    padding: 5px 8px;\n    color: #555;\n    background-color: #fff;\n    background-image: none;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n    width: auto; }\n    :host .q-input-control:disabled, :host .q-operator-control:disabled, :host .q-field-control:disabled, :host .q-entity-control:disabled {\n      border-color: transparent; }\n  :host .q-operator-control, :host .q-field-control, :host .q-entity-control, :host .q-input-control:not([type='checkbox']) {\n    min-height: 32px;\n    -webkit-appearance: none; }\n  :host .q-switch-label, :host .q-button {\n    float: left;\n    margin-bottom: 0;\n    font-size: 14px;\n    line-height: 30px;\n    font-weight: normal;\n    text-align: center;\n    text-shadow: none;\n    border: 1px solid rgba(0, 0, 0, 0.2);\n    box-sizing: border-box; }\n    :host .q-switch-label:hover, :host .q-button:hover {\n      cursor: pointer;\n      background-color: #F0F0F0; }\n  :host .q-switch-label {\n    background-color: #e4e4e4;\n    padding: 0 8px; }\n  :host .q-switch-radio {\n    position: absolute;\n    clip: rect(0, 0, 0, 0);\n    height: 1px;\n    width: 1px;\n    border: 0;\n    overflow: hidden; }\n    :host .q-switch-radio:checked + .q-switch-label {\n      border: 1px solid #619ed7;\n      background: white;\n      color: #3176b3; }\n    :host .q-switch-radio:disabled + .q-switch-label {\n      display: none; }\n    :host .q-switch-radio:checked:disabled + .q-switch-label {\n      display: initial;\n      color: initial;\n      cursor: default;\n      border-color: transparent; }\n  :host .q-invalid-ruleset {\n    border: 1px solid rgba(179, 65, 93, 0.5) !important;\n    background: rgba(179, 65, 93, 0.1) !important; }\n  :host .q-empty-warning {\n    color: #8d252e;\n    text-align: center; }\n  :host .q-ruleset {\n    border: 1px solid #CCC; }\n  :host .q-rule {\n    border: 1px solid #CCC;\n    background: white; }\n  :host .q-transition {\n    -webkit-transition: all 0.1s ease-in-out;\n    -moz-transition: all 0.1s ease-in-out;\n    -ms-transition: all 0.1s ease-in-out;\n    -o-transition: all 0.1s ease-in-out;\n    transition: all 0.1s ease-in-out; }\n  :host .q-tree-container {\n    width: 100%;\n    overflow: hidden;\n    transition: ease-in 0.25s max-height; }\n    :host .q-tree-container.q-collapsed {\n      max-height: 0 !important; }\n  :host .q-tree {\n    list-style: none;\n    margin: 4px 0 2px; }\n  :host .q-row {\n    padding: 6px 8px;\n    margin-top: 6px; }\n  :host .q-connector {\n    position: relative; }\n    :host .q-connector::before {\n      top: -5px;\n      border-width: 0 0 2px 2px; }\n    :host .q-connector::after {\n      border-width: 0 0 0 2px;\n      top: 50%; }\n    :host .q-connector::before, :host .q-connector::after {\n      content: '';\n      left: -12px;\n      border-color: #CCC;\n      border-style: solid;\n      width: 9px;\n      height: calc(50% + 6px);\n      position: absolute; }\n    :host .q-connector:last-child::after {\n      content: none; }\n  :host .q-inline-block-display {\n    display: inline-block;\n    vertical-align: top; }\n",""])},function(e,t){function n(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=o(r);return[n].concat(r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"})).concat([i]).join("\n")}return[n].join("\n")}function o(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var o=n(t,e);return t[2]?"@media "+t[2]+"{"+o+"}":o}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){"use strict";var o=this&&this.__decorate||function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=n(20),a=n(2),l=n(1),s=function(){function e(){}return e=o([r.NgModule({imports:[i.CommonModule,a.FormsModule],declarations:[l.QueryBuilderComponent,l.QueryInputDirective,l.QueryOperatorDirective,l.QueryFieldDirective,l.QueryEntityDirective,l.QueryButtonGroupDirective,l.QuerySwitchGroupDirective,l.QueryRemoveButtonDirective,l.QueryEmptyWarningDirective,l.QueryArrowIconDirective],exports:[l.QueryBuilderComponent,l.QueryInputDirective,l.QueryOperatorDirective,l.QueryFieldDirective,l.QueryEntityDirective,l.QueryButtonGroupDirective,l.QuerySwitchGroupDirective,l.QueryRemoveButtonDirective,l.QueryEmptyWarningDirective,l.QueryArrowIconDirective]})],e)}();t.QueryBuilderModule=s},function(e,t){e.exports=n}])});
//# sourceMappingURL=index.umd.min.js.map